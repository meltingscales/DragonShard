// DragonShard Database ER Diagram
digraph {
	rankdir=TB
	node [fillcolor=lightblue shape=record style=filled]
	sessions [label="{ sessions | session_id (String) PK\l target_host (String) NOT NULL\l state (SQLEnum) NOT NULL\l auth_method (SQLEnum) NOT NULL\l cookies (Text)\l headers (Text)\l ... (8 more)\l}"]
	auth_credentials [label="{ auth_credentials | id (Integer) PK\l session_id (String) FK\l username (String) NOT NULL\l password (String) NOT NULL\l token (String)\l api_key (String)\l session_id_ref (String)\l}"]
	hosts [label="{ hosts | host_id (String) PK\l hostname (String) NOT NULL\l ip_address (String) NOT NULL\l status (SQLEnum) NOT NULL\l discovered_at (Float) NOT NULL\l last_seen (Float) NOT NULL\l ... (4 more)\l}"]
	services [label="{ services | service_id (String) PK\l host_id (String) FK\l port (Integer) NOT NULL\l service_type (SQLEnum) NOT NULL\l protocol (String) NOT NULL\l banner (Text)\l version (String)\l ... (4 more)\l}"]
	vulnerabilities [label="{ vulnerabilities | vuln_id (String) PK\l service_id (String) FK\l vuln_type (String) NOT NULL\l severity (SQLEnum) NOT NULL\l description (Text) NOT NULL\l discovered_at (Float) NOT NULL\l cve_id (String)\l ... (5 more)\l}"]
	connections [label="{ connections | connection_id (String) PK\l source_host (String) FK\l target_host (String) FK\l connection_type (String) NOT NULL\l protocol (String) NOT NULL\l port (Integer) NOT NULL\l established_at (Float) NOT NULL\l last_seen (Float) NOT NULL\l ... (2 more)\l}"]
	host_vulnerabilities [label="{ host_vulnerabilities | host_id (String) PK\l vuln_id (String) PK\l}"]
	websites [label="{ websites | website_id (String) PK\l service_id (String) FK\l base_url (String) NOT NULL\l title (String)\l description (Text)\l discovered_at (Float) NOT NULL\l last_crawled_at (Float) NOT NULL\l ... (6 more)\l}"]
	website_pages [label="{ website_pages | page_id (String) PK\l website_id (String) FK\l parent_page_id (String) FK\l url (String) NOT NULL\l method (String)\l status_code (Integer)\l content_type (String)\l title (String)\l ... (6 more)\l}"]
	website_page_forms [label="{ website_page_forms | form_id (String) PK\l page_id (String) FK\l form_action (String)\l form_method (String)\l form_name (String)\l form_id_attribute (String)\l form_class (String)\l ... (4 more)\l}"]
	website_page_endpoints [label="{ website_page_endpoints | endpoint_id (String) PK\l page_id (String) FK\l endpoint_path (String)\l method (String) NOT NULL\l content_type (String)\l discovered_at (Float) NOT NULL\l is_api_endpoint (Boolean)\l ... (1 more)\l}"]
	auth_credentials -> sessions [label="FK: session_id" arrowhead=crow arrowsize=2]
	services -> hosts [label="FK: host_id" arrowhead=crow arrowsize=2]
	vulnerabilities -> services [label="FK: service_id" arrowhead=crow arrowsize=2]
	connections -> hosts [label="FK: source_host" arrowhead=crow arrowsize=2]
	connections -> hosts [label="FK: target_host" arrowhead=crow arrowsize=2]
	host_vulnerabilities -> hosts [label="FK: host_id" arrowhead=crow arrowsize=2]
	host_vulnerabilities -> vulnerabilities [label="FK: vuln_id" arrowhead=tee arrowsize=2]
	websites -> services [label="FK: service_id" arrowhead=crow arrowsize=2]
	website_pages -> websites [label="FK: website_id" arrowhead=crow arrowsize=2]
	website_pages -> website_pages [label="FK: parent_page_id" arrowhead=crow arrowsize=2]
	website_page_forms -> website_pages [label="FK: page_id" arrowhead=crow arrowsize=2]
	website_page_endpoints -> website_pages [label="FK: page_id" arrowhead=crow arrowsize=2]
}
